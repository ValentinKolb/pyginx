        {% for location in http_server.locations %}
        {% if location.comment %}
        # {{ location.comment }}
        {% endif %}
        location  {{ location.location_path }}  {

            {% if 'ProxyPass' in location.data.__class__.__name__ %}
            proxy_pass      {{ location.data.scheme }}://{{ location.data.upstream }};
            {% else %}
            {{ location.data }};
            {% endif %}

            client_max_body_size        {{ location.max_file_size }};

            {% if location.websocket_support %}
            # Websocket Support
            proxy_http_version  1.1;                                                    # use http version that supports websockets
            proxy_set_header    X-Real-IP           $remote_addr;                       # change the ip in the forwarded header to be the client ip, not the proxy ip
            # proxy_set_header  X-Forwarded-For     $proxy_add_x_forwarded_for;         # client gets request ip
            proxy_set_header    Host                $host;                              # sets host header to the addr of the nginx proxy
            proxy_set_header    Upgrade             $http_upgrade;                      # upgrades the connection
            proxy_set_header    Connection          $connection_upgrade;                # ensures the connection is upgraded
            {% endif %}
        }
        {% endfor %}